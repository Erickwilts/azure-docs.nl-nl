---
title: Azure Service Bus-berichten, payloads en serialisatie | Microsoft Documenten
description: Dit artikel biedt een overzicht van Azure Service Bus-berichten, payloads, berichtroutering en serialisatie.
services: service-bus-messaging
documentationcenter: ''
author: axisc
manager: timlt
editor: spelluru
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2020
ms.author: aschhab
ms.openlocfilehash: 11e56ae2483a254fb00e3593da7841f3f3d844f3
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 03/27/2020
ms.locfileid: "76759394"
---
# <a name="messages-payloads-and-serialization"></a>Berichten, nettoladingen en serialisatie

Microsoft Azure Service Bus verwerkt berichten. Berichten dragen een payload evenals metadata, in de vorm van key-value pair eigenschappen, het beschrijven van de payload en het geven van instructies voor het afhandelen van Service Bus en toepassingen. Af en toe is die metadata alleen voldoende om de informatie die de afzender met ontvangers wil communiceren, en de lading leeg te dragen.

Het objectmodel van de officiële Service Bus-clients voor .NET en Java weerspiegelt de abstracte servicebus-berichtstructuur, die is toegewezen aan en van de ondersteuning van de draadprotocollen servicebus.
 
Een Service Bus-bericht bestaat uit een binaire payload-sectie die Service Bus nooit verwerkt in welke vorm dan ook aan de servicezijde en twee sets eigenschappen. De *makelaar eigenschappen* zijn vooraf gedefinieerd door het systeem. Deze vooraf gedefinieerde eigenschappen bepalen de functionaliteit op berichtenniveau in de broker of ze worden toegewezen aan algemene en gestandaardiseerde metagegevensitems. De *gebruikerseigenschappen* zijn een verzameling sleutelwaardeparen die door de toepassing kunnen worden gedefinieerd en ingesteld.
 
De vooraf gedefinieerde makelaarseigenschappen worden vermeld in de volgende tabel. De namen worden gebruikt met alle officiële client API's en ook in het [JSON-object BrokerProperties](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) van de HTTP-protocoltoewijzing.
 
De gelijkwaardige namen die op AMQP-protocolniveau worden gebruikt, worden tussen haakjes weergegeven. 

| Naam van eigenschap                         | Beschrijving                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) (inhoudstype)           | Beschrijft eventueel de payload van het bericht, met een beschrijving volgens het formaat van RFC2045, sectie 5; bijvoorbeeld . `application/json`                                                                                                                                                                                                                                                                                             |
|  [CorrelationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid#Microsoft_Azure_ServiceBus_Message_CorrelationId) (correlatie-id)       | Hiermee kan een toepassing een context voor het bericht opgeven ten behoeve van correlatie; bijvoorbeeld het **bericht** weergeven van een bericht dat wordt beantwoord.                                                                                                                                                                                                                                                                  |
| [DeadLetterSource](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deadlettersource)                      | Stel alleen berichten in die doodgeletterd zijn en vervolgens automatisch zijn doorgestuurd vanuit de wachtrij voor dode letters naar een andere entiteit. Geeft de entiteit aan waarin het bericht doodgeletterd was. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                  |
| [Aantal bezorging](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount)                         | Aantal leveringen waarvoor dit bericht is geprobeerd. Het aantal wordt verhoogd wanneer een berichtvergrendeling verloopt of het bericht wordt expliciet verlaten door de ontvanger. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                                  |
| [In het aantal in de wachtrij plaatsen](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedsequencenumber)                | Voor berichten die automatisch zijn doorgestuurd, geeft deze eigenschap het volgnummer weer dat voor het eerst aan het bericht was toegewezen op het oorspronkelijke moment van indiening. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                                                |
| [InqueuedTimeUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedtimeutc)                       | Het UTC-moment waarop het bericht is geaccepteerd en opgeslagen in de entiteit. Deze waarde kan worden gebruikt als een gezaghebbende en neutrale aankomsttijdindicator wanneer de ontvanger de klok van de afzender niet wil vertrouwen. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                   |
|  [VerlooptAtUtc](/dotnet/api/microsoft.azure.servicebus.message.expiresatutc) (absolute-expiry-time) | Het UTC-moment waarop het bericht is gemarkeerd voor verwijdering en niet meer beschikbaar is voor ophalen bij de entiteit vanwege het verstrijken ervan. Expirie wordt beheerd door de eigenschap **TimeToLive** en deze eigenschap wordt berekend vanuit EnqueuedTimeUtc+TimeToLive. Deze eigenschap is alleen-lezen.                                                                                                                                                                           |
| [ForcePersistent](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence)                      | Voor wachtrijen of onderwerpen waarop de [EnableExpress-vlag](/dotnet/api/microsoft.servicebus.messaging.queuedescription.enableexpress) is ingesteld, kan deze eigenschap worden ingesteld om aan te geven dat het bericht moet worden gehandhaafd op de schijf voordat het wordt erkend. Dit is het standaardgedrag voor alle niet-uitdrukkelijke entiteiten.                                                                                                                                                                                                         |
| [Etiket](/dotnet/api/microsoft.azure.servicebus.message.label) (onderwerp)                       | Deze eigenschap stelt de toepassing in staat om het doel van het bericht op een gestandaardiseerde manier aan te geven aan de ontvanger, vergelijkbaar met een onderwerpregel voor e-mail.                                                                                                                                                                                                                                                                                  |
| [Vergrendeldtotutc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.lockeduntilutc)                        | Voor berichten die onder een vergrendeling worden opgehaald (de ontvangstmodus voor peek-lock, niet vooraf geregeld) weerspiegelt deze eigenschap het UTC-direct totdat het bericht is vergrendeld in de wachtrij/het abonnement. Wanneer het slot verloopt, wordt het [aantal bezorging](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) en is het bericht weer beschikbaar voor ophalen. Deze eigenschap is alleen-lezen.                                                                                                                         |
| [LockToken (LockToken)](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.locktoken)                             | Het slottoken is een verwijzing naar het slot dat wordt vastgehouden door de makelaar in *de peek-lock-receive-modus.* Het token kan worden gebruikt om het slot permanent vast te maken via de [Deferral](message-deferral.md) API en daarmee het bericht uit de reguliere leveringsstatusstroom te halen. Deze eigenschap is alleen-lezen.                                                                                                                                                               |
| [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid) (bericht-id)                | De bericht-id is een door de toepassing gedefinieerde waarde die het bericht en de payload ervan op unieke wijze identificeert. De id is een tekenreeks in vrije vorm en kan een GUID of een id weergeven die is afgeleid van de toepassingscontext. Indien ingeschakeld, identificeert en verwijdert de [dubbele detectiefunctie](duplicate-detection.md) de tweede en verdere inzendingen van berichten met dezelfde **MessageId**.                                                                |
| [PartitionKey](/dotnet/api/microsoft.azure.servicebus.message.partitionkey)                          | Voor [partitieentiteiten](service-bus-partitioning.md)stelt het instellen van deze waarde het toewijzen van gerelateerde berichten toe aan dezelfde interne partitie, zodat de volgorde van de indieningsvolgorde correct wordt geregistreerd. De partitie wordt gekozen door een hash-functie over deze waarde en kan niet direct worden gekozen. Voor sessiebewuste entiteiten overschrijft de eigenschap **SessionId** deze waarde.                                                                                                       |
| [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto) (reply-to)                    | Deze optionele en door de toepassing gedefinieerde waarde is een standaardmanier om een antwoordpad uit te drukken naar de ontvanger van het bericht. Wanneer een afzender een antwoord verwacht, stelt deze de waarde in op het absolute of relatieve pad van de wachtrij of het onderwerp waarnaar het antwoord wordt verzonden.                                                                                                                                           |
| [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid) (reply-to-group-id)  | Deze waarde vergroot de **ReplyTo-informatie** en geeft aan welke **SessionId** moet worden ingesteld voor het antwoord wanneer deze naar de antwoordentiteit wordt verzonden.                                                                                                                                                                                                                                                                            |
| [ScheduledenqueueTimeUtc](/dotnet/api/microsoft.azure.servicebus.message.scheduledenqueuetimeutc)               | Voor berichten die alleen beschikbaar worden gesteld voor ophalen na een vertraging, definieert deze eigenschap het UTC-moment waarop het bericht logisch in de wachtrij wordt geplaatst, gesequenced en daarom beschikbaar wordt gesteld voor ophalen.                                                                                                                                                                                                                 |
| [SequenceNummer](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sequencenumber)                        | Het volgnummer is een uniek 64-bits geheel getal dat is toegewezen aan een bericht dat wordt geaccepteerd en opgeslagen door de makelaar en fungeert als de ware id. Voor partitieentiteiten weerspiegelen de bovenste 16 bits de partitie-id. Volgordenummers monotonisch toenemen en zijn gapless. Ze rollen over naar 0 wanneer de 48-64 bit bereik is uitgeput. Deze eigenschap is alleen-lezen.                                                                |
| [SessionId](/dotnet/api/microsoft.azure.servicebus.message.sessionid) (groeps-id)                  | Voor sessiebewuste entiteiten geeft deze door toepassing gedefinieerde waarde de sessieaansluiting van het bericht aan. Berichten met dezelfde sessie-id zijn onderworpen aan een overzichtsvergrendeling en maken nauwkeurige verwerking en demultiplexing mogelijk. Voor entiteiten die niet sessiebewust zijn, wordt deze waarde genegeerd.                                                                                                                                     |
| [Grootte](/dotnet/api/microsoft.azure.servicebus.message.size)                                  | Weerspiegelt de opgeslagen grootte van het bericht in het brokerlogboek als een aantal bytes, omdat het meetelt voor het opslagquotum. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                                                                                       |
| [Staat](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.state)                                 | Geeft de status van het bericht in het logboek aan. Deze eigenschap is alleen relevant tijdens het bladeren in berichten ('peek'), om te bepalen of een bericht 'actief' is en beschikbaar is om op te halen wanneer het de bovenkant van de wachtrij bereikt, of het nu wordt uitgesteld of wacht om te worden gepland. Deze eigenschap is alleen-lezen.                                                                                                                                           |
| [TimeToLive](/dotnet/api/microsoft.azure.servicebus.message.timetolive)                            | Deze waarde is de relatieve duur waarna het bericht verloopt, vanaf het moment dat het bericht is geaccepteerd en opgeslagen door de makelaar, zoals vastgelegd in **EnqueueTimeUtc**. Wanneer deze niet expliciet is ingesteld, is de veronderstelde waarde de **DefaultTimeToLive** voor de desbetreffende wachtrij of onderwerp. De **TimeToLive-waarde** op berichtniveau mag niet langer zijn dan de **defaultTimeToLive-instelling** van de entiteit. Als het langer is, wordt het in stilte aangepast. |
| [Aan](/dotnet/api/microsoft.azure.servicebus.message.to) (aan)                               | Deze eigenschap is gereserveerd voor toekomstig gebruik in routeringsscenario's en momenteel genegeerd door de makelaar zelf. Toepassingen kunnen deze waarde gebruiken in door regels aangestuurde automatische doorstuurchainingscenario's om de beoogde logische bestemming van het bericht aan te geven.                                                                                                                                                                                   |
| [ViaPartitionKey](/dotnet/api/microsoft.azure.servicebus.message.viapartitionkey)                       | Als een bericht wordt verzonden via een transferwachtrij in het bereik van een transactie, selecteert deze waarde de transferwachtrijpartitie.                                                                                                                                                                                                                                                                                                                 |

Het abstracte berichtmodel maakt het mogelijk om een bericht via HTTP (eigenlijk altijd HTTPS) in een wachtrij te plaatsen en kan via AMQP worden opgehaald. In beide gevallen ziet het bericht er normaal uit in de context van het betreffende protocol. De makelaareigenschappen worden naar behoefte vertaald en de gebruikerseigenschappen worden toegewezen aan de meest geschikte locatie op het desbetreffende protocolberichtmodel. In HTTP worden gebruikerseigenschappen rechtstreeks van en naar HTTP-headers toegewezen. in AMQP brengen ze van en naar de **kaart met toepassingseigenschappen** in kaart.

## <a name="message-routing-and-correlation"></a>Berichtroutering en correlatie

Een subset van de eerder beschreven [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto)broker-eigenschappen, met name [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.to), [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid), [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid), [CorrelationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid)en [SessionId,](/dotnet/api/microsoft.azure.servicebus.message.sessionid)wordt gebruikt om toepassingen te helpen berichten naar bepaalde bestemmingen te routeren. Om dit te illustreren, overweeg dan een paar patronen:

- **Eenvoudig verzoek/antwoord**: Een uitgever stuurt een bericht in een wachtrij en verwacht een antwoord van de berichtconsument. Om het antwoord te ontvangen, heeft de uitgever een wachtrij waarin hij verwacht dat antwoorden worden geleverd. Het adres van die wachtrij wordt uitgedrukt in de eigenschap **ReplyTo** van het uitgaande bericht. Wanneer de consument reageert, kopieert het **de MessageId** van het afgehandelde bericht naar de eigenschap **CorrelationId** van het antwoordbericht en wordt het bericht geleverd aan de bestemming die wordt aangegeven door de eigenschap **ReplyTo.** Eén bericht kan meerdere antwoorden opleveren, afhankelijk van de toepassingscontext.
- **Multicast-verzoek/-antwoord**: Als een variant van het eerdere patroon stuurt een uitgever het bericht naar een onderwerp en komen meerdere abonnees in aanmerking voor het gebruik van het bericht. Elk van de abonnees kan reageren op de eerder beschreven manier. Dit patroon wordt gebruikt in detectie- of roll-callscenario's en de respondent identificeert zich doorgaans met een eigenschap van de gebruiker of in de payload. Als **ReplyTo** naar een onderwerp verwijst, kan een dergelijke reeks detectiereacties worden verspreid onder een doelgroep.
- **Multiplexing**: Deze sessiefunctie maakt multiplexing van streams van gerelateerde berichten mogelijk via één wachtrij of abonnement, zodat elke sessie (of groep) van gerelateerde berichten, geïdentificeerd door overeenkomende **SessionId-waarden,** wordt doorgestuurd naar een specifieke ontvanger terwijl de ontvanger de sessie binnen slot houdt. Lees [hier](message-sessions.md)meer over de details van de sessies.
- **Multiplexed request/reply**: Deze sessiefunctie maakt gemultiplexed antwoorden mogelijk, waardoor verschillende uitgevers een antwoordwachtrij kunnen delen. Door **ReplyToSessionId**in te stellen, kan de uitgever de consument(en) instrueren om die waarde te kopiëren naar de eigenschap **SessionId** van het antwoordbericht. De publicatiewachtrij of het onderwerp hoeft niet sessiebewust te zijn. Als het bericht wordt verzonden, kan de uitgever vervolgens specifiek wachten op een sessie met de gegeven **SessionId** om zich op de wachtrij te materialiseren door een sessieontvanger voorwaardelijk te accepteren. 

Routing binnen een Service Bus naamruimte kan worden gerealiseerd met behulp van auto-forward chaining en onderwerp abonnement regels. Routering over naamruimten kan worden gerealiseerd [met Azure LogicApps.](https://azure.microsoft.com/services/logic-apps/) Zoals aangegeven in de vorige lijst, de **Aan** eigenschap is gereserveerd voor toekomstig gebruik en kan uiteindelijk worden geïnterpreteerd door de makelaar met een speciaal ingeschakelde functie. Toepassingen die routering willen implementeren, moeten dit doen op basis van gebruikerseigenschappen en niet leunen op de eigenschap **Aan;** dit nu doen, zal echter geen compatibiliteitsproblemen veroorzaken.

## <a name="payload-serialization"></a>Payload serialisatie

Wanneer in transit of opgeslagen binnenkant van Service Bus, de payload is altijd een ondoorzichtig, binair blok. Met de eigenschap [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) kunnen toepassingen de payload beschrijven, waarbij de voorgestelde indeling voor de eigenschapswaarden een MIME-inhoudstypebeschrijving is volgens IETF RFC2045; bijvoorbeeld . `application/json;charset=utf-8`

In tegenstelling tot de Java- of .NET Standard-varianten ondersteunt de .NET Framework-versie van de Service Bus API het maken van **BrokeredMessage-exemplaren** door willekeurige .NET-objecten door te geven aan de constructor. 

Bij het gebruik van het verouderde SBMP-protocol worden deze objecten vervolgens geserialiseerd met de standaard binaire serialisator of met een serialisator die extern wordt geleverd. Wanneer u het AMQP-protocol gebruikt, wordt het object geserialiseerd tot een AMQP-object. De ontvanger kan deze objecten ophalen met de [GetBody\<T-methode>()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) en het verwachte type leveren. Met AMQP worden de objecten geserialiseerd in een AMQP-grafiek van **ArrayList** en **IDictionary<tekenreeks, object>** objecten en kan elke AMQP-client ze decoderen. 

Hoewel deze verborgen serialisatiemagie handig is, moeten toepassingen expliciete controle over objectserialisatie overnemen en hun objectgrafieken omzetten in streams voordat ze in een bericht worden opgenomen en het omgekeerde doen aan de ontvangerzijde. Dit levert interoperabele resultaten op. Opgemerkt moet ook worden dat terwijl AMQP heeft een krachtige binaire codering model, het is gebonden aan de AMQP messaging ecosysteem en HTTP-clients zullen moeite hebben met het decoderen van dergelijke payloads. 

Over het algemeen raden we JSON en Apache Avro aan als payload-formaten voor gestructureerde gegevens.

De .NET Standard- en Java API-varianten accepteren alleen bytearrays, wat betekent dat de toepassing objectserialisatiebesturingselementen moet verwerken. 

## <a name="next-steps"></a>Volgende stappen

Zie de volgende onderwerpen voor meer informatie over berichten over Service Bus:

* [Service Bus-wachtrijen, -onderwerpen en -abonnementen](service-bus-queues-topics-subscriptions.md)
* [Aan de slag met Service Bus-wachtrijen](service-bus-dotnet-get-started-with-queues.md)
* [Service Bus-onderwerpen en -abonnementen gebruiken](service-bus-dotnet-how-to-use-topics-subscriptions.md)
